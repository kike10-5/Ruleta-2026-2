<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>¿CÓMO IRÁ TU 2026?</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;1,300&family=IM+Fell+DW+Pica:ital@1&display=swap" rel="stylesheet">
    <style>
        :root {
            --fondo: #481d24; 
            --crema: #fdfaf0;
        }

        body { 
            background-color: var(--fondo); 
            color: var(--crema); 
            font-family: 'Cormorant Garamond', serif; 
            margin: 0; 
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            overflow: hidden;
            text-transform: uppercase;
        }

        #main-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            text-align: center;
        }

        h1 { 
            font-weight: 300;
            letter-spacing: 5px;
            margin-bottom: 20px;
            font-size: 1.2rem;
            padding: 0 10px;
        }

        #canvasContainer { 
            position: relative; 
            width: 85vw; 
            height: 85vw; 
            max-width: 450px; 
            max-height: 450px;
            cursor: pointer;
            border: 1px solid var(--crema);
            border-radius: 50%;
            box-shadow: 0 0 50px rgba(0,0,0,0.5);
        }

        canvas { width: 100%; height: 100%; display: block; border-radius: 50%; }

        #arrow { 
            position: absolute; 
            top: -15px; 
            left: 50%; 
            transform: translateX(-50%); 
            width: 0; height: 0; 
            border-left: 10px solid transparent; 
            border-right: 10px solid transparent; 
            border-top: 25px solid var(--crema); 
            z-index: 10; 
        }

        #spin { 
            background: transparent; 
            color: var(--crema); 
            border: 1px solid var(--crema); 
            padding: 12px 35px; 
            font-size: 14px; 
            margin-top: 30px;
            cursor: pointer; 
            font-family: 'Cormorant Garamond', serif;
            text-transform: uppercase;
            letter-spacing: 5px;
            font-weight: 300;
        }

        #result-screen { 
            display: none; 
            position: fixed; 
            inset: 0;
            background: var(--fondo); 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            text-align: center;
            z-index: 100;
            padding: 30px;
        }

        #songName { 
            font-family: 'IM Fell DW Pica', serif; 
            font-size: 2.5rem; 
            font-style: italic; 
            font-weight: 400;
            margin: 15px 0;
            text-transform: none; 
        }
        
        #predictionText { 
            font-family: 'Cormorant Garamond', serif;
            font-weight: 300;
            font-size: 1.1rem; 
            margin-top: 20px; 
            max-width: 90%; 
            line-height: 1.4; 
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .reset-btn {
            margin-top: 40px;
            background: none;
            color: var(--crema);
            border: 1px solid var(--crema);
            padding: 10px 25px;
            cursor: pointer;
            font-family: 'Cormorant Garamond', serif;
            text-transform: uppercase;
            letter-spacing: 3px;
            font-size: 11px;
        }
    </style>
</head>
<body>

    <div id="main-container">
        <h1>¿CÓMO IRÁ TU 2026?</h1>
        <div id="canvasContainer" onclick="spinWheel()">
            <div id="arrow"></div>
            <canvas id="canvas" width="800" height="800"></canvas>
        </div>
        <button id="spin" onclick="spinWheel()">DESCÚBRELO</button>
    </div>

    <div id="result-screen">
        <div style="font-size: 10px; letter-spacing: 6px; margin-bottom: 10px; opacity: 0.6; font-weight: 300;">EL MANUSCRITO</div>
        <h2 id="songName"></h2>
        <div id="predictionText"></div>
        <button class="reset-btn" onclick="location.reload()">VOLVER A INTENTAR</button>
    </div>

    <script>
        // Objeto base para mantener la relación canción-predicción-audio
        let data = [
            { s: "Hello Goodbye", p: "EL 2026 TE OBLIGARÁ A CERRAR UNA PUERTA PARA ABRIR OTRA. DI ADIÓS SIN MIEDO; CADA FINAL ES SOLO UN NUEVO SALUDO.", a: "hello.mp3" },
            { s: "Bienvenidos al show", p: "SENTIRÁS EL MIEDO Y EL CAOS DE EXPONERTE AL MUNDO, PERO APRENDERÁS QUE TU FRAGILIDAD ES PARTE DEL ESPECTÁCULO.", a: "bienvenidos.mp3" },
            { s: "Tramuntana", p: "TE ATREVERÁS A BUSCAR UNA VIDA FUERA DE LO COMÚN. SERÁ TU MOMENTO DE ARRIESGARLO TODO Y RENDIRTE A LO QUE TE PIDE EL CUERPO.", a: "tramuntana.mp3" },
            { s: "Money is everything", p: "EL DINERO NO TE FALTARÁ EN 2026, PERO CUIDADO: NO DEJES QUE LA AMBICIÓN TE VUELVA AGARRADO O ENGURRUÑIDO.", a: "money.mp3" },
            { s: "You're on your own, kid", p: "ESTARÁS SOLO EN ESTA ETAPA, PERO DESCUBRIRÁS QUE SIEMPRE HAS SIDO TU MEJOR ALIADO.", a: "you.mp3" },
            { s: "hope ur ok", p: "MIRARÁS HACIA ATRÁS SIN RENCOR, DESEANDO SUERTE A QUIENES YA NO ESTÁN EN TU VIDA.", a: "hope_ur_ok.mp3" },
            { s: "Let it be", p: "HAY COSAS QUE NO TIENEN SOLUCIÓN; EL 2026 SERÁ EL AÑO DE ACEPTAR EL DESTINO Y DEJARLO SER.", a: "let.mp3" },
            { s: "Yesterday", p: "LA NOSTALGIA TE VISITARÁ A MENUDO. NO HUYAS DE ELLA, ÚSALA PARA ENTENDERTE.", a: "yesterday.mp3" },
            { s: "Tengo un pensamiento", p: "TU CABEZA SERÁ UN LABERINTO DE IDEAS. APRENDERÁS A CONVIVIR CON ESE RUIDO SIN QUE TE NUBLE LA VISTA.", a: "tengo.mp3" },
            { s: "Marta, Sebas, Guille y los demás", p: "TE DARÁS CUENTA DE QUE LO ÚNICO QUE IMPORTA ES CON QUIÉN COMPARTES EL CAMINO. EL 2026 TE UNIRÁ MÁS A TUS AMIGOS REALES.", a: "marta.mp3" },
            { s: "Tengo el poder", p: "SENTIRÁS UN IMPULSO DE REBELDÍA. POR FIN TOMARÁS LAS RIENDAS DE TU PROPIO CAOS.", a: "poder.mp3" },
            { s: "Keep Driving", p: "EL MUNDO SE VOLVERÁ LOCO A TU ALREDEDOR, PERO TÚ SEGUIRÁS CONDUCIENDO HACIA TU PAZ.", a: "keep.mp3" },
            { s: "CHIHIRO", p: "TE SENTIRÁS PERDIDO EN UN LUGAR EXTRAÑO HASTA QUE RECONOZCAS TU PROPIO NOMBRE Y TU ESENCIA.", a: "chihiro.mp3" },
            { s: "Friday I'm in love", p: "APRENDERÁS A MANDAR EL CAOS A PASEO. SERÁ EL AÑO DE ENCONTRAR TU MOMENTO DE BRILLO CUANDO TODO PARECÍA PERDIDO.", a: "friday.mp3" },
            { s: "We pray", p: "EN LOS MOMENTOS DE OSCURIDAD, BUSCARÁS UNA CONEXIÓN QUE TE DÉ LAS RESPUESTAS QUE NECESITAS.", a: "we.mp3" },
            { s: "The door", p: "DEJARÁS DE ROGAR. EN 2026, SIMPLEMENTE LE ENSEÑARÁS LA PUERTA A LO QUE YA NO TIENE SITIO EN TU VIDA.", a: "the.mp3" },
            { s: "Bring me to life", p: "SALDRÁS DE TU LETARGO. UNA SACUDIDA EMOCIONAL TE HARÁ SENTIRTE VIVO Y DESPIERTO DE NUEVO.", a: "bring.mp3" },
            { s: "End of an era", p: "ACEPTARÁS QUE ALGO HA MUERTO PARA QUE ALGO NUEVO TENGA ESPACIO PARA NACER. RENOVACIÓN TOTAL.", a: "end.mp3" }
        ];

        // MÁXIMA ALEATORIEDAD: Barajamos el array entero al cargar
        for (let i = data.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [data[i], data[j]] = [data[j], data[i]];
        }

        const palette = ["#ffc857", "#e9724c", "#c5283d", "#255f85"];
        let startAngle = Math.random() * Math.PI * 2; 
        let arc = Math.PI / (data.length / 2);
        let spinning = false;
        let audioContext;

        function drawWheel() {
            const canvas = document.getElementById("canvas");
            const ctx = canvas.getContext("2d");
            ctx.clearRect(0,0,800,800);
            for(let i=0; i<data.length; i++) {
                let angle = startAngle + i * arc;
                let bgColor = palette[i % palette.length];
                ctx.fillStyle = bgColor;
                ctx.beginPath();
                ctx.arc(400, 400, 400, angle, angle + arc, false);
                ctx.lineTo(400, 400);
                ctx.fill();
                
                ctx.save();
                ctx.fillStyle = (bgColor === "#ffc857") ? "#481d24" : "#fdfaf0";
                ctx.translate(400, 400);
                ctx.rotate(angle + arc / 2);
                ctx.translate(385, 0); 
                ctx.rotate(Math.PI); 
                ctx.font = 'italic 26px "IM Fell DW Pica"';
                ctx.textAlign = "left"; 
                ctx.fillText(data[i].s, 0, 8); 
                ctx.restore();
            }
        }

        function spinWheel() {
            if (spinning) return;
            if (!audioContext) audioContext = new (window.AudioContext || window.webkitAudioContext)();
            spinning = true;
            
            // Giro con física aleatoria masiva
            let extraVueltas = (Math.floor(Math.random() * 20) + 15) * 360;
            let randomOffset = Math.random() * 360;
            let totalRotation = extraVueltas + randomOffset;
            
            let spinTimeTotal = 5000 + (Math.random() * 3000); 
            let currentSpinTime = 0;
            let spinAngleStart = (totalRotation / (spinTimeTotal / 20)) * 2;

            function rotate() {
                currentSpinTime += 20;
                if(currentSpinTime >= spinTimeTotal) {
                    stopRotate();
                    return;
                }
                let ratio = currentSpinTime / spinTimeTotal;
                let easeOut = 1 - Math.pow(1 - ratio, 5); 
                let spinAngle = spinAngleStart * (1 - easeOut);
                startAngle += (spinAngle * Math.PI / 180);
                drawWheel();
                setTimeout(rotate, 20);
            }
            rotate();
        }

        function stopRotate() {
            spinning = false;
            let degrees = startAngle * 180 / Math.PI + 90;
            let arcd = arc * 180 / Math.PI;
            let index = Math.floor((360 - degrees % 360) / arcd);
            if (index < 0) index = data.length + index;
            let finalIndex = index % data.length;

            let audio = new Audio(data[finalIndex].a);
            audio.play().catch(e => console.log("Audio no encontrado"));

            setTimeout(() => {
                document.getElementById("main-container").style.display = "none";
                const songDisplay = document.getElementById("songName");
                songDisplay.innerText = data[finalIndex].s;
                songDisplay.style.color = palette[finalIndex % palette.length];
                document.getElementById("predictionText").innerText = data[finalIndex].p;
                document.getElementById("result-screen").style.display = "flex";
            }, 500);
        }

        window.onload = drawWheel;
    </script>
</body>
</html>
